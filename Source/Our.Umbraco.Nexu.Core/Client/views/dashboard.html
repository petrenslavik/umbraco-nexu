<div ng-controller="Our.Umbraco.Nexu.DashboardController">
    <div ng-hide="isLoading">
        <div>
            <p><localize key="nexu_preventDeleteDescription">Deleting of used content is</localize> <span ng-if="preventDelete"><localize key="nexu_prevented">prevented</localize></span><span ng-if="!preventDelete"><localize key="nexu_allowed">allowed</localize></span></p>
            <p><localize key="nexu_preventUnplisheDescription">Unpublishing of used content is</localize> <span ng-if="preventDelete"><localize key="nexu_prevented">prevented</localize></span><span ng-if="!preventDelete"><localize key="nexu_allowed">allowed</localize></span></p>
        </div>
        <div ng-hide="RebuildStatus.IsProcessing">
            <div class="btn-group">
                <a class="btn" ng-click="rebuild()" prevent-default>
                    <localize key="nexu_dashboardRebuild">Rebuild nexu relations</localize>
                </a>
                <a class="btn" ng-click="getUnusedMedia()" prevent-default>
                    <localize key="nexu_dashboardUnusedMedia">Get unused media</localize>
                </a>
                <a class="btn" ng-click="deleteUnusedMedia()" ng-disabled="links.length == 0" prevent-default>
                    Delete found media
                </a>
            </div>
        </div>
        <div ng-show="RebuildStatus.IsProcessing">
            <p>
                <localize key="nexu_dashboardRebuildInProgress">Rebuilding nexu relations in progress</localize> ({{RebuildStatus.ItemsProcessed}} <localize key="nexu_dashboardItemsProcessed">items processed</localize>)
            </p>
            <p>
                <input type="checkbox" ng-model="autoRefresh" ng-checked="autoRefresh" /> <localize key="nexu_dashboardAutorefresh">Auto-refresh every 5 seconds</localize>
            </p>
            <p ng-hide="autoRefresh">
                <a class="btn" ng-click="getRebuildStatus()" prevent-default>
                    <localize key="nexu_dashboardRefresh">Refresh status</localize>
                </a>
            </p>
        </div>
        <div ng-show="links.length != 0">
            <table class="table">
                <caption>Unused media</caption>
                <thead>
                <tr>
                    <th>Index</th>
                    <th>Name</th>
                    <th>Path</th>
                    <th>ToRemove</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="link in links">
                    <td>{{$index + 1}}</td>
                    <td>{{link.Name}}</td>
                    <td>{{link.Path}}</td>
                    <td><input type="checkbox" ng-model="links[$index].ToRemove"/></td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>